# Valid8

Valid8 is a TypeScript-based toolkit for parsing and verifying mathematical logic notation, specifically supporting logical arguments in the form of premises and conclusions (P:/C: format). It evaluates arguments using truth tables to determine validity.

## Features

- **Custom DSL**: Supports logical expressions with atomic statements, compound operators (AND, OR, NOT, IMPLIES), and quantifiers (planned).
- **Truth Table Evaluation**: Automatically generates and evaluates truth tables for logical arguments.
- **CLI Interface**: Interactive mode or file-based input.
- **Modular Architecture**: Separate lexer, parser, and evaluator components.
- **Debugging Support**: Enable verbose logging with `VALID8_DEBUG=1`.
- **Packaging**: Create standalone binaries for distribution.

## Project Structure

```
valid8/
├── assets/                 # Example input files (modus_ponens.txt, modus_tollens.txt, etc.)
├── src/
│   ├── main.ts             # CLI entry point and main application logic
│   ├── evaluator/
│   │   ├── evaluator.ts    # Core evaluation engine with truth table generation
│   │   ├── evaluator.test.ts
│   │   ├── environment.ts  # Environment for storing variables and models
│   │   └── object.ts       # Object definitions
│   ├── lexer/
│   │   ├── lexer.ts        # Tokenization engine
│   │   └── lexer.test.ts
│   ├── parser/
│   │   ├── parser.ts       # AST construction from tokens
│   │   ├── parser.test.ts
│   │   └── ast.ts          # Abstract Syntax Tree node definitions
│   ├── types/
│   │   ├── token.ts        # Token types and structures
│   │   ├── error.ts        # Error handling
│   │   └── type.ts         # Type definitions
│   └── util/
│       ├── log.ts          # Logging utility
│       ├── table.ts        # Truth table printing utility
│       ├── table.test.ts
│       └── util.ts         # General utilities
├── dist/                   # Compiled JavaScript output (generated by build)
├── node_modules/           # Dependencies
├── package.json            # Project metadata and scripts
├── tsconfig.json           # TypeScript configuration
├── jest.config.js          # Testing configuration
├── AGENTS.md               # Internal project documentation
└── README.md               # This file
```

## Language Grammar
The DSL (Domain-Specific Language) has a clear structure for writing logical statements. Note: Quantified expressions (using FORALL or EXISTS) are defined in the grammar but not yet implemented in the current version.

```
# Complete Grammar for Logical Reasoning DSL

# Top-level structure
<program>        ::= <statement>+
<statement>      ::= <premise> | <conclusion>

<premise>        ::= "PREMISE" ":" <logical_expr> "."
<conclusion>     ::= "THEREFORE" ":" <logical_expr> "."

# Logical expressions (the core of the language)
<logical_expr>   ::= <quantified_expr> | <atomic_expr> | <compound_expr>

# Quantified expressions (planned but not implemented)
<quantified_expr> ::= <quantifier> "(" <variable> "," <logical_expr> ")"
<quantifier>     ::= "FORALL" | "EXISTS"

# Atomic expressions (basic facts)
<atomic_expr>    ::= <predicate> "(" <term_list> ")"
<predicate>      ::= "IS" | "ARE" | "HAS" | "CAN" | "LIKES" | <custom_predicate>

# Compound expressions (logical operators)
<compound_expr>  ::= <negation> | <conjunction> | <disjunction> | <implication>
<negation>       ::= "NOT" "(" <logical_expr> ")"
<conjunction>    ::= "AND" "(" <logical_expr> "," <logical_expr> ")"
<disjunction>    ::= "OR" "(" <logical_expr> "," <logical_expr> ")"
<implication>    ::= "IMPLIES" "(" <logical_expr> "," <logical_expr> ")"

# Terms that can appear in predicates
<term_list>      ::= <term> | <term> "," <term_list>
<term>           ::= <variable> | <constant>

# Variables and constants
<variable>       ::= <lowercase_identifier>
<constant>       ::= <identifier>
<custom_predicate> ::= <uppercase_identifier>

# Lexical rules
<lowercase_identifier> ::= [a-z] [a-z0-9_]*
<uppercase_identifier> ::= [A-Z] [A-Z0-9_]*
<identifier>     ::= [a-zA-Z] [a-zA-Z0-9_]*
```

### Basic Structure Explanation
- **Basic Structure**: A program is a list of statements, each being either a premise (starting with "PREMISE:") or a conclusion (starting with "THEREFORE:").
- **Statements**:
  - Premise: `"PREMISE" ":" <logical_expr> "."`
  - Conclusion: `"THEREFORE" ":" <logical_expr> "."`
- **Logical Expressions** (the heart of the language):
  - **Quantified** (planned but not implemented): Would use "FORALL" (for all) or "EXISTS" (there exists) to talk about variables, like "FORALL(x, ...)" meaning "for every x".
  - **Atomic**: Simple facts, like "IS(x, cat)" meaning "x is a cat". Predicates include IS, ARE, HAS, CAN, LIKES, or custom ones.
  - **Compound**: Combines expressions with NOT (negation), AND (both true), OR (at least one true), IMPLIES (if-then).
- **Terms**: Things in predicates can be variables (like x, y – lowercase) or constants (like fluffy – any word).
- **Rules for Words**: Identifiers (names) start with a letter and can have letters, numbers, or underscores.

## Code Examples
Here are some examples of valid statements in the language. Note: The first two examples use quantifiers, which are not yet supported in the current implementation.

## Installation

1. **Prerequisites**: Ensure you have Node.js (v18+) and npm installed.
2. **Clone/Setup**: Navigate to the project directory.
3. **Install dependencies**: `npm install`

## Building

- **Compile TypeScript**: `npm run build` (outputs to `dist/`)
- **Create binary**: `npm run package-all` (builds and packages into executable)
- **Clean**: `npm run clean` (removes build artifacts)

## Usage

Valid8 validates logical arguments by checking if conclusions follow from premises using truth tables.

### Interactive Mode
```bash
npm start
```
Type premises and conclusions, end with "THEREFORE" to evaluate:
```
PREMISE: IMPLIES(P, Q);
PREMISE: P;
THEREFORE: Q;
```

### File Mode
```bash
npm start assets/modus_ponens.txt
```
Or any `.txt` file with logical statements.

### Options
- `-v`: Enable verbose logging
- `-h`, `--help`: Show help message

Examples:
```bash
npm start -v assets/modus_ponens.txt  # Verbose file validation
npm start --help                      # Show help
```

### Examples
- **Modus Ponens** (`assets/modus_ponens.txt`):
  ```
  PREMISE: IMPLIES(P, Q);
  PREMISE: P;
  THEREFORE: Q;
  ```
- **Modus Tollens** (`assets/modus_tollens.txt`):
  ```
  PREMISE: IMPLIES(P, Q);
  PREMISE: NOT(Q);
  THEREFORE: NOT(P);
  ```

### Debugging
Enable verbose logs: `VALID8_DEBUG=1 npm start` or `npm start -v`

### Output
- Prints "Validity: Valid" or "Invalid"
- Displays truth table for evaluation
- Colored output for clarity

## Testing

Run tests: `npm test`

Tests cover lexer, parser, evaluator, and utilities.

## Architecture

- **Lexer**: Tokenizes input into keywords, identifiers, operators.
- **Parser**: Builds AST from tokens.
- **Evaluator**: Evaluates AST using truth tables, stores models in environment.
- **Utilities**: Logging, table printing with `cli-table3`.

## Contributing

1. Follow TypeScript strict mode.
2. Add tests for new features.
3. Use `log.debug` for debugging.
4. Update documentation as needed.

## License

ISC
